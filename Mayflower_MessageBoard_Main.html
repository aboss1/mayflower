<!DOCTYPE html>
<html>
<head>
	<title>Ship Diary</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
	<script src="http://code.jquery.com/jquery-1.12.0.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
	<style>
	</style>
</head>
<script type = "text/javascript">
$(document).ready(function() {
  // functionality for getting form data from post submission
  $("#shipmates1").submit(function() {
     var title = $("#un").val();
     var content = $("#pw").val();
     addContent("shipmates", title, content); 
     return false;
  })

  $("#pmeetups1").submit(function() {
     var title = $("#un2").val();
     var content = $("#pw2").val();
     addContent("pmeetups", title, content); 
     return false;
  })

  $("#moving1").submit(function() {
     var title = $("#un1").val();
     var content = $("#pw1").val();
     addContent("moving", title, content); 
     return false;
  })

  $("#neighbor1").submit(function() {
     var title = $("#un3").val();
     var content = $("#pw3").val();
     addContent("neighbor", title, content); 
     return false;
  })

  $("#misc1").submit(function() {
     var title = $("#un4").val();
     var content = $("#pw4").val();
     addContent("misc", title, content); 
     return false;
  })

  // functionality for replies for pre-made posts 
  $("#reply1").on("click", function() {
        $('<p> <i>Adam S. writes..</i> I agree! </p>').insertBefore("#reply1 .replies")
  })

  $("#reply2").on("click", function() {
        $('<p> <i>Adam S. writes..</i> I agree! </p>').insertBefore("#reply2 .replies")
  })

  $("#reply3").on("click", function() {
        $('<p> <i>Adam S. writes..</i> I agree! </p>').insertBefore("#reply3 .replies")
  })

  $("#reply4").on("click", function() {
        $('<p> <i>Adam S. writes..</i> I agree! </p>').insertBefore("#reply4 .replies")
  })

  $("#reply5").on("click", function() {
        $('<p> <i>Adam S. writes..</i> I agree! </p>').insertBefore("#reply5 .replies")
  })

  $("#reply6").on("click", function() {
        $('<p> <i>Adam S. writes..</i> I agree! </p>').insertBefore("#reply6 .replies")
  })

})

// functionality for replies for dynamically created posts 
function postReply(parentName) {
  var cid; 
  if(typeof parentName == "object") {
    cid = parentName[0].id;
  }
  else  {
    cid = parentName; 
  }

  $('<p> <i>Adam S. writes..</i> I agree! </p>').insertBefore("#" + cid + " button");

  $(this).off('click');
}

// functionality for adding a custom post to a message baord topic 
function addContent(parentName, titleName, messageInfo) {
   // get parent element and create a new div
   var add = document.getElementById("" + parentName + "");
   var newdiv = document.createElement('div');

   // generate a random unique id 
   var randLetter = String.fromCharCode(65 + Math.floor(Math.random() * 26));
   var uniqid = randLetter + Date.now();
   var officialid;

   // ensure that the user input is placed into the post 
   newdiv.innerHTML = "<div data-role=collapsible data-content-theme=e id=" + uniqid + ">"
   officialid = $(newdiv).find("div").attr('id');
   console.log(officialid);
   newdiv.innerHTML=  "<div data-role=collapsible data-content-theme=e id=" + officialid + "> <h3>"+ titleName + "</h3><p><i>Adam S. writes.. </i>" + messageInfo + "</p><button onclick = postReply(" + officialid + ")>Post Reply</button>";
   var id = $(newdiv).find("div").attr('id');
   console.log(id);
   add.appendChild(newdiv);

   // special jquery mobile initialization
   $("#" + id ).trigger('create');
   $('div[data-role=collapsible]').collapsible();

   // same process for adding that same post to the your posts section
   var newdiv2 = document.createElement('div');
   newdiv2.innerHTML = "<div data-role=collapsible data-content-theme=e id=" + uniqid + "><h3>"+ titleName + "</h3><p><i>Adam S. writes.. </i>" + messageInfo + " </p><button onclick = postReply(" + officialid + ")>Post Reply</button>";
   var newid = $(newdiv2).find("div").attr('id');
   var posts = document.getElementById("yourposts");
   posts.appendChild(newdiv2);
   $("#" + newid ).trigger('create');
   $('div[data-role=collapsible]').collapsible();

}

</script>
<body>

<div data-role="page" id="home">

	<div data-role="header">
		<h1>Mayflower - Ship Diary</h1>
		<div data-role="navbar">
			<ul>
				<a href="index.html" class="ui-button">Home</a>
			</ul>
		</div>
	</div>

	<div data-role="content">

		<!-- Meet Shipmates Thread -->
		<div data-role="collapsible" data-theme="a" data-content-theme="a">
   			<h3>Meet your Shipmates!</h3>
            <div id = "shipmates">
   			<a href="#popupInfo" data-rel="popup"  data-role="button"  data-position-to = "window" >Add Post</a>
               <div data-role="popup" data-theme = "c" style= "max-width:400px" class="ui-corner-all" id = "popupInfo">
                  <form id = "shipmates1" class = "addpost">
                     <h3>Create a New Post</h3>
                      <label for="un">Name of Post:</label>
                     <input type="text" id="un" value="" placeholder="" data-theme="a">
                     <label for="pw" >Post Content:</label>
                      <input type= "text" id="pw" value="" placeholder="" data-theme="a">
                     <button type="submit" data-theme="b">Add Post</button>
                  </form>

               </div>
   			<div data-role="collapsible" data-content-theme="e" id = "reply1">
   				<h3> Babz loves you all! </h3>
   				<p> <i> Babz G. writes.. </i> Hi friends, the name is Babz. I have a poodle named Monkey. Can't wait to meet all of you when I move in a month! </p>
   				<br>
   				<p> <i> Adam S. writes.. </i> No way, I have a poodle too! Do you know of any good dog parks? </p>
   				<a data-role="button" class = "replies">Post Reply</a>
   			</div>
   			<div data-role="collapsible" data-content-theme="e" id = "reply2">
   				<h3> Anyone else living in a shoebox? </h3>
   				<p> <i> Christie B. writes.. </i> Hey everyone, I'm Christie! Hopefully I'll be able to meet some of you. I'm really disappointed with my apartment. Way smaller than what I thought it would be like on Craiglist.. </p>
   				<br>
   				<p> <i> Adam S. writes.. </i> I KNOW. ME TOO. At least you don't have a shared bathroom..</p>
   				<br> 
   				<p> <i> Serena B. writes.. </i> Absolute filth.</p>
   				<a data-role="button" class = "replies">Post Reply</a>
   			</div>
         </div>
		</div>

    <!-- Moving Logistics Thread -->
		<div data-role="collapsible" data-content-theme="c">
   			<h3>Moving Logistics</h3>
            <div id = "moving">
            <a href="#popupInfo1" data-rel="popup"  data-role="button"  data-position-to = "window" >Add Post</a>
   			<div data-role="popup" data-theme = "c" style= "max-width:400px" class="ui-corner-all" id = "popupInfo1">
                  <form id = "moving1" class = "addpost">
                     <h3>Create a New Post</h3>
                      <label for="un1">Name of Post:</label>
                     <input type="text" id="un1" value="" placeholder="" data-theme="a">
                     <label for="pw1" >Post Content:</label>
                      <input type= "text" id="pw1" value="" placeholder="" data-theme="a">
                     <button type="submit" data-theme="b">Add Post</button>
                  </form>

               </div>
   			<div data-role="collapsible" data-content-theme="e" id = "reply3">
   				<h3>Mover Recommendations? </h3>
   				<p> <i> Babz G. writes.. </i> I'M BACK!!! Is QuikMover any good? Total procrastinator right here... </p>
   				<br>
   				<p> <i> Donny Y. writes.. </i> Nah I would use FastMove </p>
   				<a data-role="button" class = "replies">Post Reply</a>
   			</div>
      </div>
		</div>


    <!-- Potential Meetups Thread -->
		<div data-role="collapsible" data-content-theme="c">
   			<h3>Potential Meetups</h3>
   			 <div id = "pmeetups">
            <a href="#popupInfo2" data-rel="popup"  data-role="button"  data-position-to = "window" >Add Post</a>
               <div data-role="popup" data-theme = "c" style= "max-width:400px" class="ui-corner-all" id = "popupInfo2">
                  <form id = "pmeetups1" class = "addpost">
                     <h3>Create a New Post</h3>
                      <label for="un2">Name of Post:</label>
                     <input type="text" id="un2" value="" placeholder="" data-theme="a">
                     <label for="pw2" >Post Content:</label>
                      <input type= "text" id="pw2" value="" placeholder="" data-theme="a">
                     <button type="submit" data-theme="b" >Add Post</button>
                  </form>

               </div>
   			<div data-role="collapsible" data-content-theme="e" id = "reply4">
   				<h3> Froyo anyone? </h3>
   				<p> <i> Babz G. writes.. </i> I really can't wait to meet you all!!! I love froyo (lol). Does anyone know good places for froyo?  </p>
   				<br>
   				<p> <i> Donny Y. writes.. </i> I think Pinkberry is pretty generic, but you can make a poll to see what people like before creating a meetup event </p>
   				<br>
   				<p> <i> Babz G. writes.. </i> Thanks Donny, I'll do that. Can't wait to meet you! :) </p>
   				<br>
   				<a data-role="button" class = "replies">Post Reply</a>
   			</div>
		</div>
   </div>

    <!-- Neighborhood Questions Thread -->
		<div data-role="collapsible" data-theme="c">
   			<h3>Neighborhood Questions</h3>
   			 <div id = "neighbor">
            <a href="#popupInfo3" data-rel="popup"  data-role="button"  data-position-to = "window" >Add Post</a>
               <div data-role="popup" data-theme = "c" style= "max-width:400px" class="ui-corner-all" id = "popupInfo3">
                  <form id = "neighbor1" class = "addpost">
                     <h3>Create a New Post</h3>
                      <label for="un3">Name of Post:</label>
                     <input type="text" id="un3" value="" placeholder="" data-theme="a">
                     <label for="pw3" >Post Content:</label>
                      <input type= "text" id="pw3" value="" placeholder="" data-theme="a">
                     <button type="submit" data-theme="b" >Add Post</button>
                  </form>

               </div>
   			<div data-role="collapsible" data-content-theme="e" id= "reply5">
   				<h3> How safe is Washington Heights? </h3>
   				<p> <i> Tuongvan L. writes.. </i> I'm thinking of moving to the area and found a pretty good deal. Do you think it's safe enough? I'm in finance and work late nights, huhu.  </p>
   				<br>
   				<p> <i> Amanda B. writes.. </i> AVOID AT ALL COSTS.  </p>
   				<br>
   				<p> <i> Monica M. writes.. </i>  Totally disagree. I think it really has gone through gentrification in the past couple of years while maintaining its rich cultural roots to the Dominican community. You can check out crime rates online and see the decline. Amanda's a big wimp.  </p>
   				<br>
   				<p> <i> Amanda B. writes.. </i> :( </p>
   				<a data-role="button" class = "replies">Post Reply</a>
            </div>
         </div>
      </div>

    <!-- Misc. Thread -->
		<div data-role="collapsible" data-content-theme="c">
   			<h3>Miscellaneous</h3>
            <div id = "misc">
            <a href="#popupInfo4" data-rel="popup"  data-role="button"  data-position-to = "window" >Add Post</a>
               <div data-role="popup" data-theme = "c" style= "max-width:400px" class="ui-corner-all" id = "popupInfo4">
                  <form id = "misc1" class = "addpost">
                     <h3>Create a New Post</h3>
                      <label for="un4">Name of Post:</label>
                     <input type="text" id="un4" value="" placeholder="" data-theme="a">
                     <label for="pw4" >Post Content:</label>
                      <input type= "text" id="pw4" value="" placeholder="" data-theme="a">
                     <button type="submit" data-theme="b" >Add Post</button>
                  </form>
               </div>
               <div data-role="collapsible" data-content-theme="e" id= "reply6">
                  <h3> Do you think my dog is cute? </h3>
                  <p> <i> Tuongvan L. writes.. </i> I really am worried.. </p>
                  <br>
                  <p> <i> Amanda B. writes.. </i> So cute!!   </p>
                  <a data-role="button" class = "replies">Post Reply</a>
            </div>


            </div>
         
		</div>

     <!-- Thread that stores newly created posts -->
		<div data-role="collapsible" data-theme="b" data-content-theme="b">
   		<h3>Your Posts</h3>
       <div id = "yourposts">

       </div>
		</div>

		
		<br />

	</div><!-- /content -->

	<div data-role="footer">
		<h4>Austin -> NYC Summer '16</h4>
	</div><!-- /footer -->
</div><!-- /page -->

<div data-role="page" >
	<div data-role="header">
	<div data-role="content">


</body>
</html>